function split(t){return t.split(/,\s*/)}function extractLast(t){return split(t).pop()}jQuery.fn.multivalues_autocomplete=function(t){var e=$.extend({},t);return e.available_tags&&(source_fn=function(e,n){n($.ui.autocomplete.filter(t.available_tags,extractLast(e.term)))}),e.json_url&&(source_fn=function(t,n){$.getJSON(e.json_url,{term:extractLast(t.term)},n)}),this.bind("keydown",function(t){t.keyCode===$.ui.keyCode.TAB&&$(this).data("ui-autocomplete").menu.active&&t.preventDefault()}).autocomplete({source:source_fn,search:function(){var t=extractLast(this.value);return t.length<2?!1:void 0},focus:function(){return!1},select:function(t,e){var n=split(this.value);return n.pop(),n.push(e.item.value),this.value=n.join(", "),!1}}).data("ui-autocomplete")._renderItem=function(t,e){return $("<li>").append("<a>"+e.label+"</a>").appendTo(t)}};