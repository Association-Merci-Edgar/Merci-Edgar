function openFilters(){$(".filters-trigger").toggleClass("active"),$(".filters-outercontainer").toggleClass("open")}function filtergo_taglist(t){var a=t.data("content"),e=t.text(),i=t.attr("class");console.log(i);var s=t.closest(".tag-list").attr("id").substr(2);theactor=$("#actor_"+s),0!=$("#actor_"+s).length?(a=$hid.find("#"+s).val()+", "+a,oldtext=theactor.find(".thevalue").text(),theactor.find(".thevalue").text(oldtext+", "+e)):$(".filters-stage").append("<a class='"+i+" tag-actor active' id = actor_"+s+" href='#'><span class='close'>x</span><span class='thevalue'>"+e+"</span></a>"),$iniBTNS.show(),$hid.find("#"+s).val(a),$(".filters-stage").find(".tag-actor").click(function(){s=$(this).attr("id").substr(6),$(this).remove(),$hid.find("#"+s).val(""),hideTheInit()})}function filtergo(t){var a=t.thefield.value;console.log(a);var e=t.thefield.id.substr(2);""!=a&&(theactor=$(".filters-stage").find("#actor_"+e),0!=theactor.length?(theactor.find(".thevalue").append(", "+a),a=theactor.find(".thevalue").text()):$(".filters-stage").append("<a class='tag "+$globalClass+" tag-actor active' id = actor_"+e+" href='#'><span class='close'>x</span><span class='thevalue'>"+a+"</span></a>"),$iniBTNS.show(),$hid.find("#"+e).val(a)),$(".filters-stage .tag-actor").click(function(){e=$(this).attr("id").substr(6),$(this).remove(),$hid.find("#"+e).val(""),hideTheInit()})}function filtergogeo(t){var a=t.thefield.value,e=t.thefield.id.substr(2);""!=a&&(theactor=$(".filters-stage").find("#actor_"+e),0!=theactor.length&&$("#actor_"+e).remove(),$(".filters-stage").append("<a class='tag "+$globalClass+" tag-actor active' id = actor_"+e+" href='#'><span class='close'>x</span><span class='thevalue'>"+a+"km</span></a>"),$iniBTNS.show(),$hid.find("#"+e).val(a)),$(".filters-stage .tag-actor").click(function(){e=$(this).attr("id").substr(6),$(this).remove(),$hid.find("#"+e).val(""),hideTheInit()})}var bulking=!1;$(".bulk-switch").click(function(){$(".bulk-panel").toggleClass("active"),bulkOn()}),$(".bulk-switch-off").click(function(){$(".bulk-panel").toggleClass("active"),bulkOff(),$("input:checkbox").prop("checked",0)}),$("#checkAll").click(function(){$("input:checkbox").not(this).prop("checked",this.checked),$(this).prop("checked")?$(".bulkbox").closest("li").addClass("active"):$(".bulkbox").closest("li").removeClass("active")}),$(".bulk-one").click(function(){$(this).closest("li").toggleClass("active")}),bulkOn=function(){$(".bulkbox").addClass("active"),$(".bulk-actions").addClass("active"),bulking=!0},bulkOff=function(){$(".bulkbox").removeClass("active"),$(".bulk-actions").removeClass("active"),bulking=!1};var $hid=$("#filters-hiddenform");$("#final_submit").click(function(){$hid.submit()}),$("#final_submit_map").click(function(){$hid.find("input:last").trigger("click")}),$(".filters-trigger").click(function(){openFilters()}),$iniBTNS=$("#filters_btns"),$iniBT=$('.filters-stage [data-role="close"]'),$iniBTNS.hide(),actorsInit=function(){var t=$hid.find("input:not([type='hidden'])"),a=!1,e=[];t.each(function(){var t=$(this);if(""!=t.val()&&"show map"!=t.val()){a=!0;var i=t.attr("id"),s=t.data("text");s||(s=t.val());var o=t.attr("class");e.push(o),$(".filters-stage").append("<a class='tag "+o+" tag-actor active' id = actor_"+i+" href='#'><span class='close'>x</span><span class='thevalue'>"+s+"</span></a>")}}),a&&(openFilters(),$iniBTNS.show(),$(".filters-stage").find(".tag-actor").click(function(){var t=$(this).attr("id").substr(6);$(this).remove(),$hid.find("#"+t).val(""),hideTheInit()}))},actorsInit(),$iniBT.click(function(){$(".filters-stage .tag-actor").remove(),$hid.find("input").val(""),$iniBTNS.hide()}),hideTheInit=function(){0==$(".filters-stage").find(".tag-actor").length&&$iniBTNS.hide()};var $globalClass="",tmp=$.fn.popover.Constructor.prototype.show;$.fn.popover.Constructor.prototype.show=function(){tmp.call(this),this.options.callback&&this.options.callback()},$(".filters-pool .tag, #f_add_tags").popover({callback:function(){$(".popover-content input[autofocus]:first").focus(),$globalClass=$(".popover").prev().attr("class"),$(".popover").prev().addClass("active"),tagField=$(".popover-content input[autofocus]:first"),(tagField.data("autocomplete-source")||tagField.data("available-tags"))&&tagField.multivalues_autocomplete({available_tags:tagField.data("available-tags"),json_url:tagField.data("autocomplete-source")}),$(".popover").find(".btn[type='submit']").on("click",function(){return $(this).closest(".popover").prev().removeClass("active").popover("hide"),$(this).closest(".popover").find("form").submit(),!1}),$(".popover").find(".tag-list").find(".tag").on("click",function(t){t.preventDefault();var a=$(this);filtergo_taglist(a),$(this).closest(".popover").prev().removeClass("active").popover("hide")})},placement:"bottom",animation:!1}),$("html").on("mouseup",function(t){$(t.target).closest(".popover").length||$(t.target).hasClass("ui-corner-all")||($(".popover").each(function(){$(this.previousSibling).popover("hide")}),$(".filters-pool .tag, #f_add_tags").removeClass("active"))});