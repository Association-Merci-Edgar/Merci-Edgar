!function(){var e={}.hasOwnProperty,t=function(t,r){function o(){this.constructor=t}for(var n in r)e.call(r,n)&&(t[n]=r[n]);return o.prototype=r.prototype,t.prototype=new o,t.__super__=r.prototype,t};this.Gmaps4RailsGoogle=function(e){function r(){r.__super__.constructor.apply(this,arguments),this.map_options={disableDefaultUI:!1,disableDoubleClickZoom:!1,type:"ROADMAP"},this.markers_conf={clusterer_gridSize:50,clusterer_maxZoom:5,custom_cluster_pictures:null,custom_infowindow_class:null},this.mergeWithDefault("map_options"),this.mergeWithDefault("markers_conf"),this.kml_options={clickable:!0,preserveViewport:!1,suppressInfoWindows:!1},this.polygons_conf={strokeColor:"#FFAA00",strokeOpacity:.8,strokeWeight:2,fillColor:"#000000",fillOpacity:.35,clickable:!1},this.circles_conf={fillColor:"#00AAFF",fillOpacity:.35,strokeColor:"#FFAA00",strokeOpacity:.8,strokeWeight:2,clickable:!1,zIndex:null},this.direction_conf={panel_id:null,display_panel:!1,origin:null,destination:null,waypoints:[],optimizeWaypoints:!1,unitSystem:"METRIC",avoidHighways:!1,avoidTolls:!1,region:null,travelMode:"DRIVING"}}return t(r,e),r.prototype.createPoint=function(e,t){return new google.maps.Point(e,t)},r.prototype.createLatLng=function(e,t){return new google.maps.LatLng(e,t)},r.prototype.createLatLngBounds=function(){return new google.maps.LatLngBounds},r.prototype.createMap=function(){var e,t;return e={maxZoom:this.map_options.maxZoom,minZoom:this.map_options.minZoom,zoom:this.map_options.zoom,center:this.createLatLng(this.map_options.center_latitude,this.map_options.center_longitude),mapTypeId:google.maps.MapTypeId[this.map_options.type],mapTypeControl:this.map_options.mapTypeControl,disableDefaultUI:this.map_options.disableDefaultUI,disableDoubleClickZoom:this.map_options.disableDoubleClickZoom,draggable:this.map_options.draggable},t=this.mergeObjectWithDefault(this.map_options.raw,e),new google.maps.Map(document.getElementById(this.map_options.id),t)},r.prototype.createMarkerImage=function(e,t,r,o,n){return new google.maps.MarkerImage(e,t,r,o,n)},r.prototype.createSize=function(e,t){return new google.maps.Size(e,t)},r.prototype.createMarker=function(e){var t,r,o,n,i,s,a;return n=this.createLatLng(e.Lat,e.Lng),""===e.marker_picture&&null===e.rich_marker?(t={position:n,map:this.serviceObject,title:e.marker_title,draggable:e.marker_draggable,zIndex:e.zindex},i=this.mergeObjectWithDefault(this.markers_conf.raw,t),new google.maps.Marker(i)):null!==e.rich_marker?new RichMarker({position:n,map:this.serviceObject,draggable:e.marker_draggable,content:e.rich_marker,flat:null===e.marker_anchor?!1:e.marker_anchor[1],anchor:null===e.marker_anchor?0:e.marker_anchor[0],zIndex:e.zindex}):(r=this.createImageAnchorPosition(e.marker_anchor),s=this.createImageAnchorPosition(e.shadow_anchor),o=this.createOrRetrieveImage(e.marker_picture,e.marker_width,e.marker_height,r),a=this.createOrRetrieveImage(e.shadow_picture,e.shadow_width,e.shadow_height,s),t={position:n,map:this.serviceObject,icon:o,title:e.marker_title,draggable:e.marker_draggable,shadow:a,zIndex:e.zindex},i=this.mergeObjectWithDefault(this.markers_conf.raw,t),new google.maps.Marker(i))},r.prototype.includeMarkerImage=function(e,t){var r,o,n,i;for(r=n=0,i=e.length;i>n;r=++n)if(o=e[r],o.url===t)return r;return!1},r.prototype.createOrRetrieveImage=function(e,t,r,o){var n,i;if(""===e||null===e)return null;switch(i=this.includeMarkerImage(this.markerImages,e)){case!1:return n=this.createMarkerImage(e,this.createSize(t,r),null,o,null),this.markerImages.push(n),n;default:return"number"==typeof i?this.markerImages[i]:!1}},r.prototype.clearMarkers=function(){var e,t,r,o,n;for(o=this.markers,n=[],t=0,r=o.length;r>t;t++)e=o[t],n.push(this.clearMarker(e));return n},r.prototype.showMarkers=function(){var e,t,r,o,n;for(o=this.markers,n=[],t=0,r=o.length;r>t;t++)e=o[t],n.push(this.showMarker(e));return n},r.prototype.hideMarkers=function(){var e,t,r,o,n;for(o=this.markers,n=[],t=0,r=o.length;r>t;t++)e=o[t],n.push(this.hideMarker(e));return n},r.prototype.clearMarker=function(e){return e.serviceObject.setMap(null)},r.prototype.showMarker=function(e){return e.serviceObject.setVisible(!0)},r.prototype.hideMarker=function(e){return e.serviceObject.setVisible(!1)},r.prototype.extendBoundsWithMarkers=function(){var e,t,r,o,n;for(o=this.markers,n=[],t=0,r=o.length;r>t;t++)e=o[t],n.push(this.boundsObject.extend(e.serviceObject.position));return n},r.prototype.createClusterer=function(e){return new MarkerClusterer(this.serviceObject,e,{maxZoom:this.markers_conf.clusterer_maxZoom,gridSize:this.markers_conf.clusterer_gridSize,styles:this.customClusterer()})},r.prototype.clearClusterer=function(){return this.markerClusterer.clearMarkers()},r.prototype.clusterize=function(){var e,t,r,o,n;if(this.markers_conf.do_clustering===!0){for(null!==this.markerClusterer&&this.clearClusterer(),t=new Array,n=this.markers,r=0,o=n.length;o>r;r++)e=n[r],t.push(e.serviceObject);return this.markerClusterer=this.createClusterer(t)}},r.prototype.createInfoWindow=function(e){var t,r;return"function"==typeof this.jsTemplate||null!=e.description?("function"==typeof this.jsTemplate&&(e.description=this.jsTemplate(e)),null!==this.markers_conf.custom_infowindow_class?(t=document.createElement("div"),t.setAttribute("class",this.markers_conf.custom_infowindow_class),t.innerHTML=e.description,e.infowindow=new InfoBox(this.infobox(t)),r=this,google.maps.event.addListener(e.serviceObject,"click",this.openInfoWindow(r,e.infowindow,e.serviceObject))):(e.infowindow=new google.maps.InfoWindow({content:e.description}),r=this,google.maps.event.addListener(e.serviceObject,"click",this.openInfoWindow(r,e.infowindow,e.serviceObject)))):void 0},r.prototype.openInfoWindow=function(e,t,r){return function(){return null!==e.visibleInfoWindow&&e.visibleInfoWindow.close(),t.open(e.serviceObject,r),e.visibleInfoWindow=t}},r.prototype.createKmlLayer=function(e){var t;return t=e.options||{},t=this.mergeObjectWithDefault(t,this.kml_options),e=new google.maps.KmlLayer(e.url,t),e.setMap(this.serviceObject),e},r.prototype.create_polyline=function(e){var t,r,o,n,i,s,a,c,l,p,u,h,m,g,d;for(a=[],h=0,g=e.length;g>h;h++)if(o=e[h],null!=o.coded_array)for(r=new google.maps.geometry.encoding.decodePath(o.coded_array),m=0,d=r.length;d>m;m++)s=r[m],a.push(s);else o===e[0]&&(c=o.strokeColor||this.polylines_conf.strokeColor,l=o.strokeOpacity||this.polylines_conf.strokeOpacity,p=o.strokeWeight||this.polylines_conf.strokeWeight,t=o.clickable||this.polylines_conf.clickable,u=o.zIndex||this.polylines_conf.zIndex),null!=o.lat&&null!=o.lng&&(n=this.createLatLng(o.lat,o.lng),a.push(n));return i=new google.maps.Polyline({path:a,strokeColor:c,strokeOpacity:l,strokeWeight:p,clickable:t,zIndex:u}),e.serviceObject=i,i.setMap(this.serviceObject)},r.prototype.updateBoundsWithPolylines=function(){var e,t,r,o,n,i,s;for(i=this.polylines,s=[],o=0,n=i.length;n>o;o++)t=i[o],r=t.serviceObject.latLngs.getArray()[0].getArray(),s.push(function(){var t,o,n;for(n=[],t=0,o=r.length;o>t;t++)e=r[t],n.push(this.boundsObject.extend(e));return n}.call(this));return s},r.prototype.create_kml=function(){var e,t,r,o,n;for(o=this.kml,n=[],t=0,r=o.length;r>t;t++)e=o[t],n.push(e.serviceObject=this.createKmlLayer(e));return n},r.prototype.fitBounds=function(){return this.boundsObject.isEmpty()?void 0:this.serviceObject.fitBounds(this.boundsObject)},r.prototype.centerMapOnUser=function(){return this.serviceObject.setCenter(this.userLocation)},r.prototype.updateBoundsWithPolygons=function(){var e,t,r,o,n,i,s;for(i=this.polygons,s=[],o=0,n=i.length;n>o;o++)t=i[o],r=t.serviceObject.latLngs.getArray()[0].getArray(),s.push(function(){var t,o,n;for(n=[],t=0,o=r.length;o>t;t++)e=r[t],n.push(this.boundsObject.extend(e));return n}.call(this));return s},r.prototype.updateBoundsWithCircles=function(){var e,t,r,o,n;for(o=this.circles,n=[],t=0,r=o.length;r>t;t++)e=o[t],this.boundsObject.extend(e.serviceObject.getBounds().getNorthEast()),n.push(this.boundsObject.extend(e.serviceObject.getBounds().getSouthWest()));return n},r.prototype.extendMapBounds=function(){var e,t,r,o,n;for(o=this.map_options.bounds,n=[],t=0,r=o.length;r>t;t++)e=o[t],n.push(this.boundsObject.extend(this.createLatLng(e.lat,e.lng)));return n},r.prototype.adaptMapToBounds=function(){var e;return this.map_options.auto_zoom?this.fitBounds():(e=this.boundsObject.getCenter(),this.map_options.center_latitude=e.lat(),this.map_options.center_longitude=e.lng(),this.serviceObject.setCenter(e))},r}(Gmaps4Rails)}.call(this);