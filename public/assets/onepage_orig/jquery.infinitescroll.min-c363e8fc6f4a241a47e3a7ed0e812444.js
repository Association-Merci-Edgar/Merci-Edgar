/*
	--------------------------------
	Infinite Scroll
	--------------------------------
	+ https://github.com/paulirish/infinitescroll
	+ version 2.0b2.110713
	+ Copyright 2011 Paul Irish & Luke Shumard
	+ Licensed under the MIT license
	
	+ Documentation: http://infinite-scroll.com/
	
*/
!function(e,t,i){t.infinitescroll=function(e,i,n){this.element=t(n),this._create(e,i)},t.infinitescroll.defaults={loading:{finished:i,finishedMsg:"<em>Congratulations, you've reached the end of the internet.</em>",img:"http://www.infinite-scroll.com/loading.gif",msg:null,msgText:"<em>Loading the next set of posts...</em>",selector:null,speed:"fast",start:i},state:{isDuringAjax:!1,isInvalidPage:!1,isDestroyed:!1,isDone:!1,isPaused:!1,currPage:1},callback:i,debug:!1,behavior:i,binder:t(e),nextSelector:"div.navigation a:first",navSelector:"div.navigation",contentSelector:null,extraScrollPx:150,itemSelector:"div.post",animate:!1,pathParse:i,dataType:"html",appendCallback:!0,bufferPx:40,errorCallback:function(){},infid:0,pixelsFromNavToBottom:i,path:i},t.infinitescroll.prototype={_binding:function(e){var t=this,n=t.options;return n.behavior&&this["_binding_"+n.behavior]!==i?(this["_binding_"+n.behavior].call(this),void 0):"bind"!==e&&"unbind"!==e?(this._debug("Binding value  "+e+" not valid"),!1):("unbind"==e?this.options.binder.unbind("smartscroll.infscr."+t.options.infid):this.options.binder[e]("smartscroll.infscr."+t.options.infid,function(){t.scroll()}),this._debug("Binding",e),void 0)},_create:function(e,n){if(!this._validate(e))return!1;var a=this.options=t.extend(!0,{},t.infinitescroll.defaults,e),o=t(a.nextSelector).attr("href");return a.contentSelector=a.contentSelector||this.element,a.loading.selector=a.loading.selector||a.contentSelector,o?(a.path=this._determinepath(o),a.loading.msg=t('<div id="infscr-loading"><img alt="Loading..." src="'+a.loading.img+'" /><div>'+a.loading.msgText+"</div></div>"),(new Image).src=a.loading.img,a.pixelsFromNavToBottom=t(document).height()-t(a.navSelector).offset().top,a.loading.start=a.loading.start||function(){t(a.navSelector).hide(),a.loading.msg.appendTo(a.loading.selector).show(a.loading.speed,function(){beginAjax(a)})},a.loading.finished=a.loading.finished||function(){a.loading.msg.fadeOut("normal")},a.callback=function(e,o){a.behavior&&e["_callback_"+a.behavior]!==i&&e["_callback_"+a.behavior].call(t(a.contentSelector)[0],o),n&&n.call(t(a.contentSelector)[0],o)},this._setup(),void 0):(this._debug("Navigation selector not found"),void 0)},_debug:function(){return this.options.debug?e.console&&console.log.call(console,arguments):void 0},_determinepath:function(e){var t=this.options;if(t.behavior&&this["_determinepath_"+t.behavior]!==i)return this["_determinepath_"+t.behavior].call(this,e),void 0;if(t.pathParse)return this._debug("pathParse manual"),t.pathParse;if(e.match(/^(.*?)\b2\b(.*?$)/))e=e.match(/^(.*?)\b2\b(.*?$)/).slice(1);else if(e.match(/^(.*?)2(.*?$)/)){if(e.match(/^(.*?page=)2(\/.*|$)/))return e=e.match(/^(.*?page=)2(\/.*|$)/).slice(1);e=e.match(/^(.*?)2(.*?$)/).slice(1)}else{if(e.match(/^(.*?page=)1(\/.*|$)/))return e=e.match(/^(.*?page=)1(\/.*|$)/).slice(1);this._debug("Sorry, we couldn't parse your Next (Previous Posts) URL. Verify your the css selector points to the correct A tag. If you still get this error: yell, scream, and kindly ask for help at infinite-scroll.com."),t.state.isInvalidPage=!0}return this._debug("determinePath",e),e},_error:function(e){var t=this.options;return t.behavior&&this["_error_"+t.behavior]!==i?(this["_error_"+t.behavior].call(this,e),void 0):("destroy"!==e&&"end"!==e&&(e="unknown"),this._debug("Error",e),"end"==e&&this._showdonemsg(),t.state.isDone=!0,t.state.currPage=1,t.state.isPaused=!1,this._binding("unbind"),void 0)},_loadcallback:function(n,a){var o,s=this.options,r=this.options.callback,l=s.state.isDone?"done":s.appendCallback?"append":"no-append";if(s.behavior&&this["_loadcallback_"+s.behavior]!==i)return this["_loadcallback_"+s.behavior].call(this,n,a),void 0;switch(l){case"done":return this._showdonemsg(),!1;case"no-append":"html"==s.dataType&&(a="<div>"+a+"</div>",a=t(a).find(s.itemSelector));break;case"append":var c=n.children();if(0==c.length)return this._error("end");for(o=document.createDocumentFragment();n[0].firstChild;)o.appendChild(n[0].firstChild);this._debug("contentSelector",t(s.contentSelector)[0]),t(s.contentSelector)[0].appendChild(o),a=c.get()}if(s.loading.finished.call(t(s.contentSelector)[0],s),s.animate){var d=t(e).scrollTop()+t("#infscr-loading").height()+s.extraScrollPx+"px";t("html,body").animate({scrollTop:d},800,function(){s.state.isDuringAjax=!1})}s.animate||(s.state.isDuringAjax=!1),r(this,a)},_nearbottom:function(){var n=this.options,a=0+t(document).height()-n.binder.scrollTop()-t(e).height();return n.behavior&&this["_nearbottom_"+n.behavior]!==i?(this["_nearbottom_"+n.behavior].call(this),void 0):(this._debug("math:",a,n.pixelsFromNavToBottom),a-n.bufferPx<n.pixelsFromNavToBottom)},_pausing:function(e){var t=this.options;if(t.behavior&&this["_pausing_"+t.behavior]!==i)return this["_pausing_"+t.behavior].call(this,e),void 0;switch("pause"!==e&&"resume"!==e&&null!==e&&this._debug("Invalid argument. Toggling pause value instead"),e=!e||"pause"!=e&&"resume"!=e?"toggle":e){case"pause":t.state.isPaused=!0;break;case"resume":t.state.isPaused=!1;break;case"toggle":t.state.isPaused=!t.state.isPaused}return this._debug("Paused",t.state.isPaused),!1},_setup:function(){var e=this.options;return e.behavior&&this["_setup_"+e.behavior]!==i?(this["_setup_"+e.behavior].call(this),void 0):(this._binding("bind"),!1)},_showdonemsg:function(){var e=this.options;return e.behavior&&this["_showdonemsg_"+e.behavior]!==i?(this["_showdonemsg_"+e.behavior].call(this),void 0):(e.loading.msg.find("img").hide().parent().find("div").html(e.loading.finishedMsg).animate({opacity:1},2e3,function(){t(this).parent().fadeOut("normal")}),e.errorCallback.call(t(e.contentSelector)[0],"done"),void 0)},_validate:function(e){for(var i in e)return i.indexOf&&i.indexOf("Selector")>-1&&0===t(e[i]).length?(this._debug("Your "+i+" found no elements."),!1):!0},bind:function(){this._binding("bind")},destroy:function(){return this.options.state.isDestroyed=!0,this._error("destroy")},pause:function(){this._pausing("pause")},resume:function(){this._pausing("resume")},retrieve:function(e){var n,a,o,s,r=this,l=r.options,c=l.path,e=e||null;return e?e:l.state.currPage,beginAjax=function(e){switch(e.state.currPage++,r._debug("heading into ajax",c),n=t(e.contentSelector).is("table")?t("<tbody/>"):t("<div/>"),a=c.join(e.state.currPage),o="html"==e.dataType||"json"==e.dataType?e.dataType:"html+callback",e.appendCallback&&"html"==e.dataType&&(o+="+callback"),o){case"html+callback":r._debug("Using HTML via .load() method"),n.load(a+" "+e.itemSelector,null,function(e){r._loadcallback(n,e)});break;case"html":case"json":r._debug("Using "+o.toUpperCase()+" via $.ajax() method"),t.ajax({url:a,dataType:e.dataType,complete:function(e,t){s="undefined"!=typeof e.isResolved?e.isResolved():"success"===t||"notmodified"===t,s?r._loadcallback(n,e.responseText):r._error("end")}})}},l.behavior&&this["retrieve_"+l.behavior]!==i?(this["retrieve_"+l.behavior].call(this,e),void 0):l.state.isDestroyed?(this._debug("Instance is destroyed"),!1):(l.state.isDuringAjax=!0,l.loading.start.call(t(l.contentSelector)[0],l),void 0)},scroll:function(){var e=this.options,t=e.state;return e.behavior&&this["scroll_"+e.behavior]!==i?(this["scroll_"+e.behavior].call(this),void 0):(t.isDuringAjax||t.isInvalidPage||t.isDone||t.isDestroyed||t.isPaused||this._nearbottom()&&this.retrieve(),void 0)},toggle:function(){this._pausing()},unbind:function(){this._binding("unbind")},update:function(e){t.isPlainObject(e)&&(this.options=t.extend(!0,this.options,e))}},t.fn.infinitescroll=function(e,i){var n=typeof e;switch(n){case"string":var a=Array.prototype.slice.call(arguments,1);this.each(function(){var i=t.data(this,"infinitescroll");return i?t.isFunction(i[e])&&"_"!==e.charAt(0)?(i[e].apply(i,a),void 0):!1:!1});break;case"object":this.each(function(){var n=t.data(this,"infinitescroll");n?n.update(e):t.data(this,"infinitescroll",new t.infinitescroll(e,i,this))})}return this};var n,a=t.event;a.special.smartscroll={setup:function(){t(this).bind("scroll",a.special.smartscroll.handler)},teardown:function(){t(this).unbind("scroll",a.special.smartscroll.handler)},handler:function(e,i){var a=this,o=arguments;e.type="smartscroll",n&&clearTimeout(n),n=setTimeout(function(){t.event.handle.apply(a,o)},"execAsap"===i?0:100)}},t.fn.smartscroll=function(e){return e?this.bind("smartscroll",e):this.trigger("smartscroll",["execAsap"])}}(window,jQuery);