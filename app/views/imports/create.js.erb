$(".progress").show();
(function pollJobidStatus() {
  $.getJSON('<%= job_path(@job_id) %>', function (response) {
    if (response.status == "working") {
    	$(".bar").width(response.pct + 5 + '%');
			if (response.message != null) {
				$(".bar").text(response.message)
			}
    }
    if (response.status == "complete") {
			nb_imported_contacts = response.result["nb_imported_contacts"]
			nb_duplicates = response.result["nb_duplicates"]

			$(".progress").hide();
			$('#myModal').modal('toggle')
			console.log("result import:" + nb_imported_contacts + " / " + nb_duplicates)
			window.location = "<%= import_path(@job_id) %>"
			
			return false;
    }

    setTimeout(pollJobidStatus, 1000);
  });
}());
